<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LedgerDB | Git-Native Document Database</title>
    <meta name="description" content="LedgerDB is a git-native document database for auditability, offline-first writes, and verifiable state history.">
    <meta name="theme-color" content="#0F172A">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="LedgerDB | Git-Native Document Database">
    <meta property="og:description" content="Git-native document database for auditability, offline-first writes, and verifiable state history.">
    <meta property="og:url" content="https://github.com/osvaldoandrade/ledgerdb">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="LedgerDB | Git-Native Document Database">
    <meta name="twitter:description" content="Git-native document database for auditability, offline-first writes, and verifiable state history.">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        ledger: {
                            bg: '#0F172A',      // Slate 900 (Base)
                            card: '#1E293B',    // Slate 800 (Cards)
                            border: '#334155',  // Slate 700 (Borders)
                            primary: '#6366F1', // Indigo 500
                            accent: '#06B6D4',  // Cyan 500
                            pink: '#EC4899',    // Pink 500
                            text: '#F8FAFC',    // Slate 50
                            muted: '#94A3B8'    // Slate 400
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #0F172A;
            color: #F8FAFC;
            overflow-x: hidden;
        }
        
        /* Glassmorphism Card Style */
        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .glass-card:hover {
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -10px rgba(99, 102, 241, 0.3);
        }

        /* Chart Containers */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }

        /* Reveal Animation Classes */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0F172A; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Tree Diagram Lines */
        .tree-line-v { width: 2px; background-color: #334155; margin: 0 auto; }
        .tree-line-h { height: 2px; background-color: #334155; }

        /* Step Hover Description */
        .step-desc {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            font-size: 0.7rem;
            color: #94A3B8;
            margin-top: 0;
        }
        .glass-card:hover .step-desc {
            max-height: 50px;
            opacity: 1;
            margin-top: 0.5rem;
        }

        .tab-btn {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid #334155;
            color: #94A3B8;
            padding: 0.4rem 0.9rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .tab-btn.active {
            background: #F8FAFC;
            color: #0F172A;
            border-color: transparent;
            box-shadow: 0 8px 20px -12px rgba(248, 250, 252, 0.6);
        }
        .tab-panel {
            display: none;
        }
        .tab-panel.active {
            display: block;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navbar -->
    <nav class="fixed top-0 w-full z-50 bg-ledger-bg/80 backdrop-blur-md border-b border-ledger-border transition-all duration-300" id="navbar">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="font-display font-bold text-xl tracking-tight text-white">LedgerDB</span>
            </div>
            
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-ledger-muted">
                <a href="#get-started" class="hover:text-white transition-colors">Get Started</a>
                <a href="#architecture" class="hover:text-white transition-colors">Architecture</a>
                <a href="#workflow" class="hover:text-white transition-colors">Write Flow</a>
                <a href="#performance" class="hover:text-white transition-colors">Performance</a>
                <a href="#faq" class="hover:text-white transition-colors">FAQ</a>
            </div>

            <a href="https://github.com/osvaldoandrade/ledgerdb" target="_blank" class="group relative inline-flex items-center justify-center px-5 py-2 overflow-hidden font-medium text-white transition duration-300 ease-out border border-ledger-border rounded-full shadow-md hover:bg-white/5">
                <i class="fa-brands fa-github text-lg mr-2"></i>
                <span>GitHub</span>
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative pt-32 pb-24 lg:pt-48 lg:pb-32 overflow-hidden">
        <!-- Ambient Glow -->
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[500px] bg-ledger-primary/10 rounded-full blur-[120px] pointer-events-none"></div>

        <div class="container mx-auto px-4 text-center relative z-10">
            
            <h1 class="text-5xl md:text-7xl font-bold font-display tracking-tight mb-6 reveal" style="transition-delay: 100ms;">
                Database as <span class="text-transparent bg-clip-text bg-gradient-to-r from-ledger-primary to-ledger-accent">Code</span>.
            </h1>
            
            <p class="text-lg md:text-xl text-gray-400 leading-relaxed max-w-2xl mx-auto mb-10 reveal" style="transition-delay: 200ms;">
                Immutable transaction files inside a Git repository. <br class="hidden md:block" />
                No global locks. Deterministic concurrency. 100% Audit trail.
            </p>

            <div class="flex flex-col sm:flex-row justify-center items-center gap-4 reveal" style="transition-delay: 300ms;">
                <a href="#get-started" class="px-8 py-3.5 rounded-xl bg-white text-ledger-bg font-bold hover:bg-gray-200 transition-all duration-200 shadow-[0_0_20px_rgba(255,255,255,0.2)]">
                    Get Started
                </a>
                <a href="https://github.com/osvaldoandrade/ledgerdb" target="_blank" class="px-8 py-3.5 rounded-xl border border-ledger-border text-gray-300 hover:text-white hover:border-white transition-all duration-200">
                    <i class="fa-brands fa-github mr-2"></i> View Source
                </a>
            </div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto mt-16 reveal" style="transition-delay: 400ms;">
                <div class="glass-card p-4 rounded-xl text-center">
                    <div class="text-ledger-primary text-2xl mb-2"><i class="fa-solid fa-code-branch"></i></div>
                    <div class="font-bold text-white">Git-Native</div>
                    <div class="text-xs text-gray-400">Replication Engine</div>
                </div>
                <div class="glass-card p-4 rounded-xl text-center">
                    <div class="text-ledger-accent text-2xl mb-2"><i class="fa-solid fa-file-contract"></i></div>
                    <div class="font-bold text-white">JSON Schema</div>
                    <div class="text-xs text-gray-400">Strict Validation</div>
                </div>
                <div class="glass-card p-4 rounded-xl text-center">
                    <div class="text-ledger-pink text-2xl mb-2"><i class="fa-solid fa-database"></i></div>
                    <div class="font-bold text-white">SQLite Sidecar</div>
                    <div class="text-xs text-gray-400">Instant Queries</div>
                </div>
                <div class="glass-card p-4 rounded-xl text-center">
                    <div class="text-emerald-400 text-2xl mb-2"><i class="fa-solid fa-fingerprint"></i></div>
                    <div class="font-bold text-white">Verifiable</div>
                    <div class="text-xs text-gray-400">Hash Chaining</div>
                </div>
            </div>
        </div>
    </header>

    <main class="space-y-32 pb-32">

        <!-- SECTION 0: GET STARTED -->
        <section id="get-started" class="container mx-auto px-4 reveal">
            <div class="text-center mb-12">
                <span class="text-ledger-accent font-mono text-sm tracking-widest uppercase">Get Started</span>
                <h2 class="text-3xl md:text-4xl font-display font-bold mt-2">From Git Repo to Queryable Data</h2>
                <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
                    A Git-native ledger with a SQLite sidecar index for fast reads and near real-time updates.
                </p>
            </div>

            <div class="max-w-4xl mx-auto">
                <div class="glass-card p-8 rounded-2xl" data-tab-group="quickstart">
                    <div class="flex items-center justify-between flex-wrap gap-4 mb-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <i class="fa-solid fa-terminal text-ledger-accent"></i> Quick Start
                        </h3>
                        <div class="flex flex-wrap gap-2" role="tablist" aria-label="Quick start tabs">
                            <button class="tab-btn active" data-tab="cli" type="button" aria-selected="true">CLI</button>
                            <button class="tab-btn" data-tab="go" type="button" aria-selected="false">Go</button>
                            <button class="tab-btn" data-tab="rust" type="button" aria-selected="false">Rust</button>
                            <button class="tab-btn" data-tab="ts" type="button" aria-selected="false">TypeScript</button>
                        </div>
                    </div>

                    <div class="tab-panel active" data-tab-panel="cli">
                        <pre class="bg-black/30 border border-ledger-border rounded-xl p-4 text-xs md:text-sm text-gray-200 overflow-x-auto"><code># Build
make build

# Init repo (sharded + append history)
ledgerdb init --name "LedgerDB" --repo ./ledgerdb.git --layout sharded --history-mode append

# Apply schema and write data
ledgerdb collection apply tasks --schema ./schemas/task.json --indexes "status,assignee"
ledgerdb doc put tasks "task_0001" --payload '{"title":"Ship v1","status":"todo","priority":"high"}'

# Watch the SQLite index (state mode)
ledgerdb index watch --db ./index.db --mode state --interval 1s --fast --batch-commits 200</code></pre>
                        <p class="text-xs text-gray-400 mt-3">
                            Tip: use <span class="text-white">--history-mode amend</span> for compact state-only repos, or <span class="text-white">--sync=false</span> for offline writes.
                        </p>
                    </div>

                    <div class="tab-panel" data-tab-panel="go">
                        <pre class="bg-black/30 border border-ledger-border rounded-xl p-4 text-xs md:text-sm text-gray-200 overflow-x-auto"><code>package main

import "github.com/osvaldoandrade/ledgerdb/sdk/go/ledgerdb" // preview

func main() {
  db, _ := ledgerdb.Open("./ledgerdb.git")
  _ = db.Collection("tasks").Put("task_0001", map[string]any{
    "title": "Ship v1",
    "status": "todo",
    "priority": "high",
  })

  _ = db.Index().Watch(ledgerdb.IndexOptions{
    Path: "./index.db",
    Mode: "state",
    Interval: "1s",
    Fast: true,
  })
}</code></pre>
                        <p class="text-xs text-gray-400 mt-3">SDK preview. API surface may change.</p>
                    </div>

                    <div class="tab-panel" data-tab-panel="rust">
                        <pre class="bg-black/30 border border-ledger-border rounded-xl p-4 text-xs md:text-sm text-gray-200 overflow-x-auto"><code>use ledgerdb::Client; // preview

#[tokio::main]
async fn main() -> Result<(), ledgerdb::Error> {
    let db = Client::open("./ledgerdb.git").await?;
    db.collection("tasks")
        .put("task_0001", serde_json::json!({
            "title": "Ship v1",
            "status": "todo",
            "priority": "high"
        }))
        .await?;

    db.index().watch(ledgerdb::IndexOptions {
        db_path: "./index.db".into(),
        mode: "state".into(),
        interval: "1s".into(),
        fast: true,
    }).await?;
    Ok(())
}</code></pre>
                        <p class="text-xs text-gray-400 mt-3">SDK preview. API surface may change.</p>
                    </div>

                    <div class="tab-panel" data-tab-panel="ts">
                        <pre class="bg-black/30 border border-ledger-border rounded-xl p-4 text-xs md:text-sm text-gray-200 overflow-x-auto"><code>import { LedgerDB } from "@ledgerdb/sdk"; // preview

const db = await LedgerDB.open({ repo: "./ledgerdb.git" });
await db.collection("tasks").put("task_0001", {
  title: "Ship v1",
  status: "todo",
  priority: "high"
});

await db.index.watch({
  db: "./index.db",
  mode: "state",
  interval: "1s",
  fast: true
});</code></pre>
                        <p class="text-xs text-gray-400 mt-3">SDK preview. API surface may change.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 1: ARCHITECTURE (Visual Tree) -->
        <section id="architecture" class="container mx-auto px-4 reveal">
            <div class="text-center mb-12">
                <span class="text-ledger-primary font-mono text-sm tracking-widest uppercase">System Design</span>
                <h2 class="text-3xl md:text-4xl font-display font-bold mt-2">The Database is the Filesystem</h2>
                <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
                    LedgerDB maps logical concepts directly to a directory structure.
                    History lives in <span class="text-white">documents/</span>, current state in <span class="text-white">state/</span>,
                    and schemas in <span class="text-white">collections/</span>. The SQLite sidecar sits next to the repo for fast queries.
                </p>
            </div>

            <div class="max-w-5xl mx-auto glass-card p-8 md:p-12 rounded-3xl relative overflow-hidden">
                <!-- Subtle Grid Background -->
                <div class="absolute inset-0 opacity-[0.03]" style="background-image: linear-gradient(#fff 1px, transparent 1px), linear-gradient(90deg, #fff 1px, transparent 1px); background-size: 20px 20px;"></div>

                <!-- Tree Diagram -->
                <div class="relative z-10 font-mono text-sm md:text-base">
                    <!-- Root -->
                    <div class="flex flex-col items-center">
                <div class="bg-ledger-bg border border-ledger-border px-6 py-3 rounded-lg shadow-xl flex items-center gap-3 relative z-10">
                            <i class="fa-solid fa-server text-ledger-primary"></i>
                            <div>
                                <div class="font-bold text-white">db-root/</div>
                                <div class="text-[10px] text-gray-400 flex items-center gap-2">
                                    <i class="fa-regular fa-file-lines"></i> db.yaml
                                </div>
                            </div>
                        </div>
                        <div class="tree-line-v h-8"></div>
                    </div>

                    <!-- Connectors -->
                    <div class="flex justify-center relative mb-8">
                        <div class="w-3/4 border-t-2 border-ledger-border absolute top-0"></div>
                        <!-- Vertical Lines Drop -->
                        <div class="w-full flex justify-between px-[12.5%]">
                            <div class="tree-line-v h-8"></div> <!-- Left -->
                            <div class="tree-line-v h-8"></div> <!-- Center -->
                            <div class="tree-line-v h-8"></div> <!-- Right -->
                        </div>
                    </div>

                    <!-- Branches -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        
                        <!-- Col 1: Config -->
                        <div class="flex flex-col items-center">
                            <div class="glass-card w-full p-4 rounded-xl border-l-4 border-l-ledger-accent">
                                <div class="flex items-center gap-2 mb-3 text-ledger-accent font-bold">
                                    <i class="fa-regular fa-folder-open"></i> collections/
                                </div>
                                <ul class="space-y-2 text-xs text-gray-400 pl-4">
                                    <li class="flex items-center gap-2"><i class="fa-solid fa-file-code"></i> schema.json</li>
                                    <li class="flex items-center gap-2"><i class="fa-solid fa-list-check"></i> indexes.json</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Col 2: Documents (Hot) -->
                        <div class="flex flex-col items-center transform md:-translate-y-4">
                            <div class="glass-card w-full p-4 rounded-xl border-l-4 border-l-ledger-pink shadow-[0_0_30px_-10px_rgba(236,72,153,0.3)]">
                                <div class="flex items-center justify-between mb-3 text-ledger-pink font-bold">
                                    <div class="flex items-center gap-2"><i class="fa-regular fa-folder-open"></i> documents/</div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] border border-ledger-pink/60 text-ledger-pink px-2 rounded">SHARDED</span>
                                        <span class="text-[10px] bg-ledger-pink text-white px-2 rounded">HISTORY</span>
                                    </div>
                                </div>
                                <div class="bg-white/5 rounded p-3 border border-white/5">
                                    <div class="text-xs text-gray-300 mb-2">DOC_&lt;hash&gt;/</div>
                                    <ul class="space-y-2 text-xs pl-2 border-l border-ledger-border ml-1">
                                        <li class="flex items-center justify-between text-white font-bold group cursor-pointer">
                                            <span><i class="fa-solid fa-location-arrow text-ledger-pink mr-1"></i> HEAD</span>
                                            <span class="text-[9px] text-gray-500 group-hover:text-ledger-pink transition-colors">POINTER</span>
                                        </li>
                                        <li class="flex items-center gap-2 text-ledger-primary"><i class="fa-regular fa-file-lines"></i> tx/2025..._put.txpb</li>
                                        <li class="flex items-center gap-2 text-gray-600"><i class="fa-regular fa-file-lines"></i> tx/2025..._patch.txpb</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Col 3: State -->
                        <div class="flex flex-col items-center">
                            <div class="glass-card w-full p-4 rounded-xl border-l-4 border-l-emerald-500 opacity-80 hover:opacity-100 transition-opacity">
                                <div class="flex items-center justify-between mb-3 text-emerald-500 font-bold">
                                    <div class="flex items-center gap-2"><i class="fa-regular fa-folder-open"></i> state/</div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] border border-emerald-400/60 text-emerald-300 px-2 rounded">SHARDED</span>
                                        <span class="text-[10px] bg-emerald-500 text-white px-2 rounded">LATEST</span>
                                    </div>
                                </div>
                                <div class="bg-white/5 rounded p-3 border border-white/5">
                                    <div class="text-xs text-gray-300 mb-2">DOC_&lt;hash&gt;/</div>
                                    <ul class="space-y-2 text-xs pl-2 border-l border-ledger-border ml-1">
                                        <li class="flex items-center justify-between text-white font-bold">
                                            <span><i class="fa-solid fa-location-arrow text-emerald-400 mr-1"></i> HEAD</span>
                                            <span class="text-[9px] text-gray-500">POINTER</span>
                                        </li>
                                        <li class="flex items-center gap-2 text-emerald-300"><i class="fa-regular fa-file-lines"></i> tx/current.txpb</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: WORKFLOW (9 Steps Grid) -->
        <section id="workflow" class="container mx-auto px-4 reveal">
            <div class="text-center mb-12">
                <span class="text-ledger-pink font-mono text-sm tracking-widest uppercase">Concurrency Model</span>
                <h2 class="text-3xl md:text-4xl font-display font-bold mt-2">CAS Write Flow (Optimistic)</h2>
                <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
                    Writes are serialized by an atomic compare-and-set on <span class="text-white">refs/heads/main</span>, with retries on conflict.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-9 gap-4 relative">
                <!-- Connector Line (Desktop Only) -->
                <div class="hidden lg:block absolute top-1/2 left-0 w-full h-1 bg-ledger-border -z-10 rounded-full transform -translate-y-1/2"></div>

                <!-- Steps Generation -->
                <!-- 1. Read Ref -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">1</div>
                    <i class="fa-solid fa-code-branch text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Read Main Ref</h4>
                    <p class="step-desc">Load refs/heads/main</p>
                </div>

                <!-- 2. Read Stream -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">2</div>
                    <i class="fa-solid fa-glasses text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Read Stream HEAD</h4>
                    <p class="step-desc">Resolve current tx pointer</p>
                </div>

                <!-- 3. Build -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">3</div>
                    <i class="fa-solid fa-hammer text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Build Tx</h4>
                    <p class="step-desc">Create transaction object</p>
                </div>

                <!-- 4. Hash -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">4</div>
                    <i class="fa-solid fa-link text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Canonicalize</h4>
                    <p class="step-desc">Compute SHA-256 hashes</p>
                </div>

                <!-- 5. Validate -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">5</div>
                    <i class="fa-solid fa-check-double text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Validate</h4>
                    <p class="step-desc">Check JSON Schema</p>
                </div>

                <!-- 6. Write Blobs (Highlight) -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">6</div>
                    <i class="fa-solid fa-file-export text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Write Blobs</h4>
                    <p class="step-desc">Tx + HEAD + state</p>
                </div>

                <!-- 7. Build Commit -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">7</div>
                    <i class="fa-solid fa-diagram-project text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Build Commit</h4>
                    <p class="step-desc">Update tree + commit</p>
                </div>

                <!-- 8. CAS Update -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">8</div>
                    <i class="fa-solid fa-shield-halved text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">CAS Update</h4>
                    <p class="step-desc">Check-and-set main ref</p>
                </div>

                <!-- 9. Retry -->
                <div class="glass-card p-4 rounded-xl flex flex-col items-center text-center gap-2 h-full justify-center group relative bg-ledger-bg">
                    <div class="w-8 h-8 rounded-full bg-ledger-border text-white flex items-center justify-center font-bold text-xs absolute -top-4 border-4 border-ledger-bg group-hover:bg-white transition-colors">9</div>
                    <i class="fa-solid fa-rotate-right text-gray-400 text-xl mb-1"></i>
                    <h4 class="font-bold text-xs uppercase text-gray-300">Retry/Backoff</h4>
                    <p class="step-desc">On conflict, retry</p>
                </div>
            </div>
        </section>

        <!-- SECTION 3: PERFORMANCE (Charts) -->
        <section id="performance" class="container mx-auto px-4 reveal">
            <div class="mb-12 flex flex-col md:flex-row justify-between items-end border-b border-ledger-border pb-6">
                <div>
                    <span class="text-ledger-accent font-mono text-sm tracking-widest uppercase">Performance</span>
                    <h2 class="text-3xl md:text-4xl font-display font-bold mt-2">Predictable, Measured, Rebuildable</h2>
                    <p class="text-gray-400 mt-2">Writes are O(1) appends. Reads are rehydrated or served from the SQLite sidecar.</p>
                </div>
                <div class="mt-4 md:mt-0 text-right">
                    <div class="text-ledger-pink font-bold text-3xl">32</div>
                    <div class="text-xs text-gray-500 uppercase">Default Max Chain</div>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-8">
                <!-- Throughput Chart -->
                <div class="glass-card p-6 rounded-2xl flex flex-col">
                    <h3 class="text-lg font-bold text-white mb-2 flex items-center gap-2">
                        <i class="fa-solid fa-chart-simple text-ledger-accent"></i> Measured Write Throughput
                    </h3>
                    <p class="text-xs text-gray-400 mb-4 h-12">
                        CLI benchmarks from local runs. Each bar shows average writes/sec for a specific history + index mode.
                    </p>
                    <div class="chart-container flex-grow">
                        <canvas id="complexityChart"></canvas>
                    </div>
                    <div class="mt-4 grid gap-2 text-xs text-gray-400">
                        <div><span class="text-white">Append + State</span> — 5000 puts / 2500 updates / 100 deletes (1s watch)</div>
                        <div><span class="text-white">Amend + State</span> — 2000 puts / 400 updates / 100 deletes (1s watch)</div>
                        <div><span class="text-white">State Watch 250ms</span> — 1000 puts / 200 updates / 40 deletes</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: FAQ (No Storage Chart) -->
        <section id="faq" class="container mx-auto px-4 reveal">
            <div class="max-w-4xl mx-auto space-y-4">
                <h3 class="text-2xl font-bold text-white mb-6 text-center">Frequently Asked Questions</h3>
                
                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>What problem does LedgerDB solve?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        LedgerDB is for applications that need auditability, offline-first writes, and easy replication without running a centralized database service. It stores immutable transactions in Git, so teams can reduce infrastructure overhead while keeping a reliable, verifiable history of state changes.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>How do reads work (CQRS + SQLite sidecar)?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        Git is the write model and source of truth. The SQLite sidecar is a derived read model that can be rebuilt at any time. The indexer tails commits or the state tree and projects documents into tables for fast queries.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>What is the state index and why is it fast?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        The state tree stores the latest snapshot per document. Indexing in <span class="text-white">state</span> mode diffs the state tree and applies only changed docs (O(changes)), which makes near real-time updates practical.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>What are append vs amend history modes?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        <span class="text-white">Append</span> keeps full history per document (audit trail). <span class="text-white">Amend</span> stores only the latest state per document (compact). Both can use the state index for fast reads.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>Why sharding in the filesystem?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        Sharding spreads files across deep directories so large collections stay fast and avoid OS directory limits. It keeps lookup time stable as the dataset grows.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>What happens when a push is rejected?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        A push can be rejected when the remote advanced (non-fast-forward). The client fetches the new head and detects divergence. If auto-merge is enabled, it rehydrates both histories, applies a deterministic merge policy, writes a merge transaction, and retries the push. If it cannot merge safely, it surfaces a conflict for manual resolution.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>Do you need Raft or consensus to be safe?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        LedgerDB uses optimistic concurrency with atomic compare-and-set on the Git ref. You can choose a coordinator for single-writer semantics, or layer consensus if strict linearizability is required, but it is not mandatory for correctness.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>How is the tree validated during commit?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        Each write produces deterministic transaction bytes, hashes them, and updates the stream HEAD pointer. The commit rewrites only the affected paths, then atomically swaps refs/heads/main. If the ref moved, the write is rejected and retried, guaranteeing the committed tree matches the expected parent state.
                    </div>
                </details>

                <details class="glass-card rounded-xl group">
                    <summary class="flex justify-between items-center p-6 cursor-pointer font-bold text-white list-none">
                        <span>Is LedgerDB a replacement for Redis or DynamoDB?</span>
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down text-ledger-primary"></i></span>
                    </summary>
                    <div class="px-6 pb-6 text-gray-400 text-sm leading-relaxed border-t border-ledger-border/50 pt-4">
                        Not a drop-in replacement. LedgerDB trades microsecond latency and managed global throughput for auditability, offline-first writes, and decentralized replication. It can be a lower-cost alternative for many workloads that do not need a centralized cloud database.
                    </div>
                </details>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-[#020408] border-t border-ledger-border py-12">
        <div class="container mx-auto px-4 text-center">
            <h4 class="text-2xl font-display font-bold text-white mb-2">LedgerDB</h4>
            <p class="text-gray-500 mb-8 max-w-sm mx-auto">The open-source, git-native database for high-integrity systems.</p>
            
            <a href="https://github.com/osvaldoandrade/ledgerdb" target="_blank" class="inline-flex items-center text-gray-400 hover:text-white transition-colors">
                <i class="fa-brands fa-github text-xl mr-2"></i> osvaldoandrade/ledgerdb
            </a>

            <div class="mt-12 pt-8 border-t border-white/5 text-xs text-gray-700">
                &copy; 2026 LedgerDB. Released under MIT License.
            </div>
        </div>
    </footer>

    <!-- Scripts for Charts & Animation -->
    <script>
        // --- 1. Colors & Defaults ---
        const colors = {
            primary: '#6366F1',
            accent: '#06B6D4',
            pink: '#EC4899',
            purple: '#8B5CF6',
            text: '#94A3B8'
        };
        Chart.defaults.color = colors.text;
        Chart.defaults.borderColor = '#334155';
        Chart.defaults.font.family = "'Inter', sans-serif";

        // --- 2. Scroll Reveal Observer ---
        document.addEventListener('DOMContentLoaded', () => {
            const reveals = document.querySelectorAll('.reveal');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if(entry.isIntersecting) {
                        entry.target.classList.add('active');
                    }
                });
            }, { threshold: 0.1 });
            
            reveals.forEach(el => observer.observe(el));

            const tabGroups = document.querySelectorAll('[data-tab-group]');
            tabGroups.forEach(group => {
                const buttons = group.querySelectorAll('[data-tab]');
                const panels = group.querySelectorAll('[data-tab-panel]');
                const activate = (name) => {
                    buttons.forEach(btn => {
                        const active = btn.dataset.tab === name;
                        btn.classList.toggle('active', active);
                        btn.setAttribute('aria-selected', active ? 'true' : 'false');
                    });
                    panels.forEach(panel => {
                        panel.classList.toggle('active', panel.dataset.tabPanel === name);
                    });
                };
                if (buttons.length > 0) {
                    activate(buttons[0].dataset.tab);
                }
                buttons.forEach(btn => {
                    btn.addEventListener('click', () => activate(btn.dataset.tab));
                });
            });
        });

        // --- 3. Throughput Chart ---
        const valueLabelPlugin = {
            id: 'valueLabel',
            afterDatasetsDraw(chart) {
                const { ctx } = chart;
                ctx.save();
                chart.data.datasets.forEach((dataset, datasetIndex) => {
                    const meta = chart.getDatasetMeta(datasetIndex);
                    if (meta.hidden) {
                        return;
                    }
                    meta.data.forEach((element, index) => {
                        const value = dataset.data[index];
                        const label = Number(value).toFixed(2);
                        ctx.fillStyle = '#F8FAFC';
                        ctx.font = '12px Inter, sans-serif';
                        ctx.textAlign = 'left';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(label, element.x + 8, element.y);
                    });
                });
                ctx.restore();
            }
        };
        Chart.register(valueLabelPlugin);

        const ctxComp = document.getElementById('complexityChart').getContext('2d');
        new Chart(ctxComp, {
            type: 'bar',
            data: {
                labels: ['Append + State', 'Amend + State', 'State watch 250ms'],
                datasets: [{
                    label: 'Avg writes/sec',
                    data: [56.72, 65.79, 65.26],
                    backgroundColor: [colors.accent, colors.primary, colors.pink],
                    borderRadius: 6,
                    barThickness: 22
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => `${ctx.parsed.x} writes/sec`
                        }
                    }
                },
                scales: { 
                    y: { grid: { display: false } },
                    x: {
                        beginAtZero: true,
                        grid: { color: 'rgba(51,65,85,0.4)' },
                        title: { display: true, text: 'avg writes/sec' }
                    }
                }
            }
        });
    </script>
</body>
</html>
